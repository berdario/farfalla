<!doctype html>
<!-- Copyright 2010 Nicholas C. Zakas. All rights reserved. BSD Licensed. -->
<html>
<body>
<script type="text/javascript">
(function(){

    function handleRequest(event){
         var data = JSON.parse(event.data);
         switch (data.action){
             case "get":
                 var value = localStorage.getItem(data.key);
                 event.source.postMessage(JSON.stringify({id: data.id, key:data.key, value: value}), event.origin);
                 break;
             case "set":
                 localStorage.setItem(data.key, data.value);
                 break;
             case "clear":
                 localStorage.clear();
                 break;
         }
    }

    if(window.addEventListener){
        window.addEventListener("message", handleRequest, false);
    } else if (window.attachEvent){
        window.attachEvent("onmessage", handleRequest);
    }
})();
</script>
</body>
</html>
